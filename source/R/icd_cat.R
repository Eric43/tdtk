#' Assigns an injury group based upon ICD 10 code name#'#' Given one or a vector of ICD-10 codes for the primary injury use#' the overall categories to group.#'#' This is a basic minimal viable product due to difficult obtaining#' all the ICD 10 codes at the time of initial authorship. The list#' was compiled by looking at the unique diagnosis.  Goal is to later#' obtain all the trauma injury codes and develop a lookup table.#' First version was written using unique entries and assignment.#' Need to add non-firearm penetrating injury (NFPI), blunt, animal#' and others as needed.#'#' @author Eric W. Olle, \email{eric.olle@@gmail.com}#' @references \url{https:\\ <Enter git hub or other reference>}#'#' @keywords ICD, grouping#'#' @param ICD is the location or one code to look up.#'#' @return returns the overall group the injury is assigned to#'     (i.e. MVC, FARI, fall, NFPI (non firearm penetrating injury),#'     blunt, animal, poison, etc.)#'#' @examples \dontrun{#'#' # Just one#'#' test_icd <- ("all-terrain")#'#' icd_cat(ICD = test_icd)#'#' # Map across and entire data frame#'#' purr::map_chr(trauma_data$ISS, icd_cat)#'#' }#'#'#' @exporticd_cat <- function (ICD = ... ){### Need to look at a way to Cross reference into the existing ICD-10 look up table### This meathod or a regex will work better than current version.  Mvt_grp <- c("driver|passenger|occupant|Person boarding or alighting a car|unspecified motor-vehicle accident|Driver|Passenger|Occupant")      Fall_grp <- c("Fall")  Firearms_grp <- c("unspecisfied firearms|hunting rifle|spring-operated gun|shotgun|handgun|Unspecified firearms|firearm|Firearm|firearms|machine gun")  Motorcycle_grp <- c("Motorcycle")  Pedestrian_grp <- c("Pedal|Pedestrian")  Atv_grp <- c("all-terrain")  if (is.na(ICD)) {    cat <- NA  }else if (str_detect(ICD, Mvt_grp)){    cat <- "MVT"  }else if (str_detect(ICD,Fall_grp)){    cat <- "Fall"  } else if (str_detect(ICD, Firearms_grp)){    cat <- "FARI" #Firearm Related Injury  }else if (str_detect(ICD, Motorcycle_grp)){    cat <- "MtrC"  } else if (str_detect(ICD, Pedestrian_grp)){    cat <- "Pedestrian/Pedal"  } else if (str_detect(ICD, Atv_grp)){    cat <- "ATV"  }else {    cat <- NA  }  return(cat)}# ---------------------------- ## spell checked 31 jan